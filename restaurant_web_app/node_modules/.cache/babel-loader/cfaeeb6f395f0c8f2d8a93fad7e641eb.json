{"ast":null,"code":"import { userConstants } from '../constants';\nimport { alertActions } from './';\nimport fire from \"../firebase\";\nexport var dataActions = {\n  populateDashboard: populateDashboard\n};\n\nfunction populateDashboard() {\n  var _this = this;\n\n  return function (dispatch) {\n    var locations;\n    fire.database().ref('/lockers/data').once('value', function (snapshot) {\n      var tempArray = {};\n      snapshot.forEach(function (childSnapshot) {\n        var childData = childSnapshot.val();\n        tempArray[childSnapshot.key] = childData;\n      });\n      locations = tempArray;\n      dispatch(mealsSuccess(tempArray));\n    }.bind(_this));\n    console.log(locations);\n    var mealsForSale;\n    fire.database().ref('/meals/forSale').once('value', function (snapshot) {\n      var tempArray = {};\n      snapshot.forEach(function (childSnapshot) {\n        var childData = childSnapshot.val();\n        tempArray[childSnapshot.key] = childData;\n      });\n      mealsForSale = tempArray;\n    }, function (error) {\n      if (error) {\n        dispatch(mealsFailure(error.toString()));\n        dispatch(alertActions.error(error.toString()));\n      }\n    });\n    console.log(mealsForSale);\n    var pickedUp;\n    fire.database().ref('/restaurants/' + org + '/inventory/pickedUp').once('value', function (snapshot) {\n      var tempArray = {};\n      snapshot.forEach(function (childSnapshot) {\n        var childData = childSnapshot.val();\n        tempArray[childSnapshot.key] = childData;\n      });\n      pickedUp = tempArray;\n    }.bind(_this));\n    console.log(pickedUp);\n    fire.auth().signInWithEmailAndPassword(email, password).then(function (user) {\n      var tempUser = {};\n\n      if (user) {\n        fire.database().ref('/users/' + user.user.uid).once('value').then(function (snapshot) {\n          tempUser[\"name\"] = snapshot.val().name;\n          tempUser[\"headshot\"] = snapshot.val().headshot;\n          tempUser[\"phone\"] = snapshot.val().phone;\n          tempUser[\"org\"] = snapshot.val().org;\n          localStorage.setItem('user', JSON.stringify(user.valueOf()));\n          dispatch(success(user, tempUser));\n          history.push('/');\n        }, function (error) {\n          localStorage.setItem('user', null);\n          dispatch(failure(error.toString()));\n          dispatch(alertActions.error(error.toString()));\n        });\n        dispatch(request({\n          email: email\n        }));\n      }\n    }, function (error) {\n      localStorage.setItem('user', null);\n      dispatch(failure(error.toString()));\n      dispatch(alertActions.error(error.toString()));\n    });\n    var user = JSON.parse(localStorage.getItem('user'));\n    console.log(user);\n  };\n\n  function mealsRequest(user) {\n    return {\n      type: userConstants.UPDATE_MEALS_REQUEST,\n      user: user\n    };\n  }\n\n  function mealsSuccess(user, userData) {\n    return {\n      type: userConstants.UPDATE_MEALS_SUCCESS,\n      user: user,\n      userData: userData\n    };\n  }\n\n  function mealsFailure(error) {\n    return {\n      type: userConstants.UPDATE_MEALS_FAILURE,\n      error: error\n    };\n  }\n\n  function locationsRequest(user) {\n    return {\n      type: userConstants.UPDATE_LOCATIONS_REQUEST,\n      user: user\n    };\n  }\n\n  function locationsSuccess(user, userData) {\n    return {\n      type: userConstants.UPDATE_LOCATIONS_SUCCESS,\n      user: user,\n      userData: userData\n    };\n  }\n\n  function locationsFailure(error) {\n    return {\n      type: userConstants.UPDATE_LOCATIONS_FAILURE,\n      error: error\n    };\n  }\n\n  function pickedUpRequest(user) {\n    return {\n      type: userConstants.UPDATE_PICKEDUP_REQUEST,\n      user: user\n    };\n  }\n\n  function pickedUpSuccess(user, userData) {\n    return {\n      type: userConstants.UPDATE_PICKEDUP_SUCCESS,\n      user: user,\n      userData: userData\n    };\n  }\n\n  function pickedUpFailure(error) {\n    return {\n      type: userConstants.UPDATE_PICKEDUP_FAILURE,\n      error: error\n    };\n  }\n}\n\n;","map":{"version":3,"sources":["/mnt/c/Users/jbuxofplenty/Github/fudlocker/restaurant_web_app/src/actions/data.actions.js"],"names":["userConstants","alertActions","fire","dataActions","populateDashboard","dispatch","locations","database","ref","once","snapshot","tempArray","forEach","childSnapshot","childData","val","key","mealsSuccess","bind","console","log","mealsForSale","error","mealsFailure","toString","pickedUp","org","auth","signInWithEmailAndPassword","email","password","then","user","tempUser","uid","name","headshot","phone","localStorage","setItem","JSON","stringify","valueOf","success","history","push","failure","request","parse","getItem","mealsRequest","type","UPDATE_MEALS_REQUEST","userData","UPDATE_MEALS_SUCCESS","UPDATE_MEALS_FAILURE","locationsRequest","UPDATE_LOCATIONS_REQUEST","locationsSuccess","UPDATE_LOCATIONS_SUCCESS","locationsFailure","UPDATE_LOCATIONS_FAILURE","pickedUpRequest","UPDATE_PICKEDUP_REQUEST","pickedUpSuccess","UPDATE_PICKEDUP_SUCCESS","pickedUpFailure","UPDATE_PICKEDUP_FAILURE"],"mappings":"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","sourcesContent":["import { userConstants } from '../constants';\r\nimport { alertActions } from './';\r\nimport fire from \"../firebase\";\n\nexport const dataActions = {\r\n  populateDashboard,\r\n};\n\nfunction populateDashboard() {\n  return dispatch => {\n    var locations;\r\n    fire.database().ref('/lockers/data').once('value', function (snapshot) {\r\n      let tempArray = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        var childData = childSnapshot.val();\r\n        tempArray[childSnapshot.key] = childData;\r\n      });\r\n      locations = tempArray;\r\n      dispatch(mealsSuccess(tempArray));\r\n    }.bind(this));\r\n    console.log(locations);\r\n\r\n    var mealsForSale;\r\n    fire.database().ref('/meals/forSale').once('value', function (snapshot) {\r\n      let tempArray = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        var childData = childSnapshot.val();\r\n        tempArray[childSnapshot.key] = childData;\r\n      });\r\n      mealsForSale = tempArray;\r\n    }, function (error) {\r\n      if (error) {\r\n        dispatch(mealsFailure(error.toString()));\r\n        dispatch(alertActions.error(error.toString()));\r\n      } \r\n    });\r\n    console.log(mealsForSale);\r\n\r\n    var pickedUp;\r\n    fire.database().ref('/restaurants/' + org + '/inventory/pickedUp').once('value', function (snapshot) {\r\n      let tempArray = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        var childData = childSnapshot.val();\r\n        tempArray[childSnapshot.key] = childData;\r\n      });\r\n      pickedUp = tempArray;\r\n    }.bind(this));\r\n    console.log(pickedUp);\n\r\n    fire.auth()\r\n      .signInWithEmailAndPassword(email, password)\r\n      .then(user => {\n        var tempUser = {};\n        if (user) {\n          fire.database().ref('/users/' + user.user.uid).once('value').then(function (snapshot) {\r\n            tempUser[\"name\"] = snapshot.val().name;\r\n            tempUser[\"headshot\"] = snapshot.val().headshot;\r\n            tempUser[\"phone\"] = snapshot.val().phone;\r\n            tempUser[\"org\"] = snapshot.val().org;\r\n            localStorage.setItem('user', JSON.stringify(user.valueOf()));\r\n            dispatch(success(user, tempUser));\n            history.push('/');\r\n          },\r\n            error => {\r\n              localStorage.setItem('user', null);\r\n              dispatch(failure(error.toString()));\r\n              dispatch(alertActions.error(error.toString()));\r\n            });\r\n          dispatch(request({ email }));\r\n        }\r\n      },\r\n        error => {\r\n          localStorage.setItem('user', null);\r\n          dispatch(failure(error.toString()));\r\n          dispatch(alertActions.error(error.toString()));\r\n        });\n\n\n    var user = JSON.parse(localStorage.getItem('user'));\n    console.log(user);\r\n  };\r\n\r\n  function mealsRequest(user) { return { type: userConstants.UPDATE_MEALS_REQUEST, user } }\r\n  function mealsSuccess(user, userData) { return { type: userConstants.UPDATE_MEALS_SUCCESS, user, userData } }\r\n  function mealsFailure(error) { return { type: userConstants.UPDATE_MEALS_FAILURE, error } }\r\n  function locationsRequest(user) { return { type: userConstants.UPDATE_LOCATIONS_REQUEST, user } }\r\n  function locationsSuccess(user, userData) { return { type: userConstants.UPDATE_LOCATIONS_SUCCESS, user, userData } }\r\n  function locationsFailure(error) { return { type: userConstants.UPDATE_LOCATIONS_FAILURE, error } }\n  function pickedUpRequest(user) { return { type: userConstants.UPDATE_PICKEDUP_REQUEST, user } }\r\n  function pickedUpSuccess(user, userData) { return { type: userConstants.UPDATE_PICKEDUP_SUCCESS, user, userData } }\r\n  function pickedUpFailure(error) { return { type: userConstants.UPDATE_PICKEDUP_FAILURE, error } }\r\n  };\n"]},"metadata":{},"sourceType":"module"}