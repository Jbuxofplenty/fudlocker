{"ast":null,"code":"import { dataConstants } from '../constants';\nimport { alertActions } from './';\nimport fire from \"../firebase\";\nexport var dataActions = {\n  populateDashboard: populateDashboard,\n  populateAddMeal: populateAddMeal,\n  populateInventory: populateInventory,\n  populateStatistics: populateStatistics\n};\n\nfunction populateStatistics() {\n  var randomScalingFactor = function randomScalingFactor() {\n    return Math.round(Math.random() * 100);\n  };\n\n  var lineChartData = {\n    labels: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\"],\n    datasets: [{\n      label: \"My First dataset\",\n      fillColor: \"rgba(220,220,220,0.2)\",\n      strokeColor: \"rgba(220,220,220,1)\",\n      pointColor: \"rgba(220,220,220,1)\",\n      pointStrokeColor: \"#fff\",\n      pointHighlightFill: \"#fff\",\n      pointHighlightStroke: \"rgba(220,220,220,1)\",\n      data: [randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor()]\n    }, {\n      label: \"My Second dataset\",\n      fillColor: \"rgba(151,187,205,0.2)\",\n      strokeColor: \"rgba(151,187,205,1)\",\n      pointColor: \"rgba(151,187,205,1)\",\n      pointStrokeColor: \"#fff\",\n      pointHighlightFill: \"#fff\",\n      pointHighlightStroke: \"rgba(151,187,205,1)\",\n      data: [randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor()]\n    }]\n  };\n  return function (dispatch) {\n    fire.database().ref('/lockers/data').once('value', function (snapshot) {\n      var tempArray = {};\n      snapshot.forEach(function (childSnapshot) {\n        var childData = childSnapshot.val();\n        tempArray[childData[\"type\"]] = childData;\n      });\n      localStorage.setItem('locations', JSON.stringify(tempArray));\n      dispatch(locationsSuccess(tempArray));\n    }, function (error) {\n      if (error) {\n        dispatch(locationsFailure(error.toString()));\n        dispatch(alertActions.error(error.toString()));\n      }\n    });\n    var pickedUp = JSON.parse(localStorage.getItem('pickedUp'));\n    fire.database().ref('/restaurants/' + user.org + '/orders/purchased').once('value', function (snapshot) {\n      var tempCompleted = {};\n      var tempPurchased = {};\n      snapshot.forEach(function (childSnapshot) {\n        childSnapshot.forEach(function (childChildSnapshot) {\n          var childData = childChildSnapshot.val();\n\n          if (pickedUp[childChildSnapshot.key]) {\n            for (var i in childData) {\n              tempCompleted[childChildSnapshot.key] = childData[i];\n            }\n          }\n\n          for (var j in childData) {\n            tempPurchased[childChildSnapshot.key] = childData[j];\n          }\n        });\n      });\n      localStorage.setItem('completed', JSON.stringify(tempCompleted));\n      dispatch(completedSuccess(tempCompleted));\n      localStorage.setItem('purchased', JSON.stringify(tempPurchased));\n      dispatch(purchasedSuccess(tempPurchased));\n    }, function (error) {\n      if (error) {\n        dispatch(completedFailure(error.toString()));\n        dispatch(alertActions.error(error.toString()));\n      }\n    });\n  };\n\n  function completedSuccess(data) {\n    return {\n      type: dataConstants.UPDATE_COMPLETED_ORDERS_SUCCESS,\n      data: data\n    };\n  }\n\n  function completedFailure(error) {\n    return {\n      type: dataConstants.UPDATE_COMPLETED_ORDERS_FAILURE,\n      error: error\n    };\n  }\n\n  function purchasedSuccess(data) {\n    return {\n      type: dataConstants.UPDATE_PURCHASED_SUCCESS,\n      data: data\n    };\n  }\n\n  function locationsSuccess(data) {\n    return {\n      type: dataConstants.UPDATE_LOCATIONS_SUCCESS,\n      data: data\n    };\n  }\n\n  function locationsFailure(error) {\n    return {\n      type: dataConstants.UPDATE_LOCATIONS_FAILURE,\n      error: error\n    };\n  }\n}\n\nfunction populateAddMeal() {\n  var user = JSON.parse(localStorage.getItem('userData'));\n  return function (dispatch) {\n    fire.database().ref('/restaurants/' + user.org + '/lockers/data').once('value', function (snapshot) {\n      var tempArray = {};\n      snapshot.forEach(function (childSnapshot) {\n        var childData = childSnapshot.val();\n        tempArray[childData[\"type\"]] = childData;\n      });\n      localStorage.setItem('locations', JSON.stringify(tempArray));\n      dispatch(locationsSuccess(tempArray));\n    }, function (error) {\n      if (error) {\n        dispatch(locationsFailure(error.toString()));\n        dispatch(alertActions.error(error.toString()));\n      }\n    });\n  };\n\n  function locationsSuccess(data) {\n    return {\n      type: dataConstants.UPDATE_LOCATIONS_SUCCESS,\n      data: data\n    };\n  }\n\n  function locationsFailure(error) {\n    return {\n      type: dataConstants.UPDATE_LOCATIONS_FAILURE,\n      error: error\n    };\n  }\n}\n\nfunction populateInventory() {\n  var user = JSON.parse(localStorage.getItem('userData'));\n  return function (dispatch) {\n    fire.database().ref('/restaurants/' + user.org + '/templates/default/').once('value', function (snapshot) {\n      var tempArray = {};\n      snapshot.forEach(function (childSnapshot) {\n        var childData = childSnapshot.val();\n        tempArray[childData[\"idTemplate\"]] = childData;\n      });\n      localStorage.setItem('inventory', JSON.stringify(tempArray));\n      dispatch(inventorySuccess(tempArray));\n    }, function (error) {\n      if (error) {\n        dispatch(inventoryFailure(error.toString()));\n        dispatch(alertActions.error(error.toString()));\n      }\n    });\n  };\n\n  function inventorySuccess(data) {\n    return {\n      type: dataConstants.UPDATE_INVENTORY_SUCCESS,\n      data: data\n    };\n  }\n\n  function inventoryFailure(error) {\n    return {\n      type: dataConstants.UPDATE_INVENTORY_FAILURE,\n      error: error\n    };\n  }\n}\n\nfunction populateDashboard() {\n  return function (dispatch) {\n    fire.database().ref('/lockers/data').once('value', function (snapshot) {\n      var tempArray = {};\n      snapshot.forEach(function (childSnapshot) {\n        var childData = childSnapshot.val();\n        tempArray[childSnapshot.val().type] = childData;\n      });\n      localStorage.setItem('locations', JSON.stringify(tempArray));\n      dispatch(locationsSuccess(tempArray));\n    }, function (error) {\n      if (error) {\n        dispatch(locationsFailure(error.toString()));\n        dispatch(alertActions.error(error.toString()));\n      }\n    });\n    fire.database().ref('/meals/forSale').once('value', function (snapshot) {\n      var tempArray = {};\n      snapshot.forEach(function (childSnapshot) {\n        var childData = childSnapshot.val();\n        tempArray[childSnapshot.key] = childData;\n      });\n      localStorage.setItem('mealsForSale', JSON.stringify(tempArray));\n      dispatch(mealsForSaleSuccess(tempArray));\n    }, function (error) {\n      if (error) {\n        dispatch(mealsForSaleFailure(error.toString()));\n        dispatch(alertActions.error(error.toString()));\n      }\n    });\n    var mealsForSale = JSON.parse(localStorage.getItem('mealsForSale'));\n    fire.database().ref('/meals/all/meals').once('value', function (snapshot) {\n      var tempArray = {};\n      snapshot.forEach(function (childSnapshot) {\n        var childData = childSnapshot.val();\n\n        if (mealsForSale[childSnapshot.key]) {\n          for (var i in childData) {\n            tempArray[childSnapshot.key] = childData[i];\n          }\n        }\n      });\n      localStorage.setItem('meals', JSON.stringify(tempArray));\n      dispatch(mealsSuccess(tempArray));\n    }, function (error) {\n      if (error) {\n        dispatch(mealsFailure(error.toString()));\n        dispatch(alertActions.error(error.toString()));\n      }\n    });\n    var user = JSON.parse(localStorage.getItem('userData'));\n    fire.database().ref('/restaurants/' + user.org + '/inventory/pickedUp').once('value', function (snapshot) {\n      var tempArray = {};\n      snapshot.forEach(function (childSnapshot) {\n        var childData = childSnapshot.val();\n        tempArray[childSnapshot.key] = childData;\n      });\n      localStorage.setItem('pickedUp', JSON.stringify(tempArray));\n      dispatch(pickedUpSuccess(tempArray));\n    }, function (error) {\n      if (error) {\n        dispatch(pickedUpFailure(error.toString()));\n        dispatch(alertActions.error(error.toString()));\n      }\n    });\n    var pickedUp = JSON.parse(localStorage.getItem('pickedUp'));\n    fire.database().ref('/restaurants/' + user.org + '/orders/purchased').once('value', function (snapshot) {\n      var tempCompleted = {};\n      var tempPurchased = {};\n      snapshot.forEach(function (childSnapshot) {\n        childSnapshot.forEach(function (childChildSnapshot) {\n          var childData = childChildSnapshot.val();\n\n          if (pickedUp[childChildSnapshot.key]) {\n            for (var i in childData) {\n              tempCompleted[childChildSnapshot.key] = childData[i];\n            }\n          }\n\n          for (var j in childData) {\n            tempPurchased[childChildSnapshot.key] = childData[j];\n          }\n        });\n      });\n      localStorage.setItem('completed', JSON.stringify(tempCompleted));\n      dispatch(completedSuccess(tempCompleted));\n      localStorage.setItem('purchased', JSON.stringify(tempPurchased));\n      dispatch(purchasedSuccess(tempPurchased));\n    }, function (error) {\n      if (error) {\n        dispatch(completedFailure(error.toString()));\n        dispatch(alertActions.error(error.toString()));\n      }\n    });\n  };\n\n  function mealsSuccess(data) {\n    return {\n      type: dataConstants.UPDATE_MEALS_SUCCESS,\n      data: data\n    };\n  }\n\n  function mealsFailure(error) {\n    return {\n      type: dataConstants.UPDATE_MEALS_FOR_SALE_FAILURE,\n      error: error\n    };\n  }\n\n  function completedSuccess(data) {\n    return {\n      type: dataConstants.UPDATE_COMPLETED_ORDERS_SUCCESS,\n      data: data\n    };\n  }\n\n  function completedFailure(error) {\n    return {\n      type: dataConstants.UPDATE_COMPLETED_ORDERS_FAILURE,\n      error: error\n    };\n  }\n\n  function purchasedSuccess(data) {\n    return {\n      type: dataConstants.UPDATE_PURCHASED_SUCCESS,\n      data: data\n    };\n  }\n\n  function mealsForSaleFailure(error) {\n    return {\n      type: dataConstants.UPDATE_MEALS_FAILURE,\n      error: error\n    };\n  }\n\n  function mealsForSaleSuccess(data) {\n    return {\n      type: dataConstants.UPDATE_MEALS_FOR_SALE_SUCCESS,\n      data: data\n    };\n  }\n\n  function locationsSuccess(data) {\n    return {\n      type: dataConstants.UPDATE_LOCATIONS_SUCCESS,\n      data: data\n    };\n  }\n\n  function locationsFailure(error) {\n    return {\n      type: dataConstants.UPDATE_LOCATIONS_FAILURE,\n      error: error\n    };\n  }\n\n  function pickedUpSuccess(data) {\n    return {\n      type: dataConstants.UPDATE_PICKEDUP_SUCCESS,\n      data: data\n    };\n  }\n\n  function pickedUpFailure(error) {\n    return {\n      type: dataConstants.UPDATE_PICKEDUP_FAILURE,\n      error: error\n    };\n  }\n}\n\n;","map":{"version":3,"sources":["/mnt/c/Users/jbuxofplenty/Github/fudlocker/restaurant_web_app/src/actions/data.actions.js"],"names":["dataConstants","alertActions","fire","dataActions","populateDashboard","populateAddMeal","populateInventory","populateStatistics","randomScalingFactor","Math","round","random","lineChartData","labels","datasets","label","fillColor","strokeColor","pointColor","pointStrokeColor","pointHighlightFill","pointHighlightStroke","data","dispatch","database","ref","once","snapshot","tempArray","forEach","childSnapshot","childData","val","localStorage","setItem","JSON","stringify","locationsSuccess","error","locationsFailure","toString","pickedUp","parse","getItem","user","org","tempCompleted","tempPurchased","childChildSnapshot","key","i","j","completedSuccess","purchasedSuccess","completedFailure","type","UPDATE_COMPLETED_ORDERS_SUCCESS","UPDATE_COMPLETED_ORDERS_FAILURE","UPDATE_PURCHASED_SUCCESS","UPDATE_LOCATIONS_SUCCESS","UPDATE_LOCATIONS_FAILURE","inventorySuccess","inventoryFailure","UPDATE_INVENTORY_SUCCESS","UPDATE_INVENTORY_FAILURE","mealsForSaleSuccess","mealsForSaleFailure","mealsForSale","mealsSuccess","mealsFailure","pickedUpSuccess","pickedUpFailure","UPDATE_MEALS_SUCCESS","UPDATE_MEALS_FOR_SALE_FAILURE","UPDATE_MEALS_FAILURE","UPDATE_MEALS_FOR_SALE_SUCCESS","UPDATE_PICKEDUP_SUCCESS","UPDATE_PICKEDUP_FAILURE"],"mappings":"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","sourcesContent":["import { dataConstants } from '../constants';\r\nimport { alertActions } from './';\r\nimport fire from \"../firebase\";\r\n\r\nexport const dataActions = {\r\n  populateDashboard,\r\n  populateAddMeal,\r\n  populateInventory,\n  populateStatistics,\r\n};\n\nfunction populateStatistics() {\n  var randomScalingFactor = function () { return Math.round(Math.random() * 100) };\r\n  var lineChartData = {\r\n    labels: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\"],\r\n    datasets: [\r\n      {\r\n        label: \"My First dataset\",\r\n        fillColor: \"rgba(220,220,220,0.2)\",\r\n        strokeColor: \"rgba(220,220,220,1)\",\r\n        pointColor: \"rgba(220,220,220,1)\",\r\n        pointStrokeColor: \"#fff\",\r\n        pointHighlightFill: \"#fff\",\r\n        pointHighlightStroke: \"rgba(220,220,220,1)\",\r\n        data: [randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor()]\r\n      },\r\n      {\r\n        label: \"My Second dataset\",\r\n        fillColor: \"rgba(151,187,205,0.2)\",\r\n        strokeColor: \"rgba(151,187,205,1)\",\r\n        pointColor: \"rgba(151,187,205,1)\",\r\n        pointStrokeColor: \"#fff\",\r\n        pointHighlightFill: \"#fff\",\r\n        pointHighlightStroke: \"rgba(151,187,205,1)\",\r\n        data: [randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor()]\r\n      }\r\n    ]\r\n  }\n  return dispatch => {\r\n    fire.database().ref('/lockers/data').once('value', function (snapshot) {\r\n      let tempArray = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        var childData = childSnapshot.val();\r\n        tempArray[childData[\"type\"]] = childData;\r\n      });\r\n      localStorage.setItem('locations', JSON.stringify(tempArray));\r\n      dispatch(locationsSuccess(tempArray));\r\n    }, function (error) {\r\n      if (error) {\r\n        dispatch(locationsFailure(error.toString()));\r\n        dispatch(alertActions.error(error.toString()));\r\n      }\r\n    });\n\n    var pickedUp = JSON.parse(localStorage.getItem('pickedUp'));\r\n    fire.database().ref('/restaurants/' + user.org + '/orders/purchased').once('value', function (snapshot) {\r\n      let tempCompleted = {};\r\n      let tempPurchased = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        childSnapshot.forEach(function (childChildSnapshot) {\r\n          var childData = childChildSnapshot.val();\r\n          if (pickedUp[childChildSnapshot.key]) {\r\n            for (var i in childData) {\r\n              tempCompleted[childChildSnapshot.key] = childData[i];\r\n            }\r\n          }\r\n          for (var j in childData) {\r\n            tempPurchased[childChildSnapshot.key] = childData[j];\r\n          }\r\n        })\r\n      });\r\n      localStorage.setItem('completed', JSON.stringify(tempCompleted));\r\n      dispatch(completedSuccess(tempCompleted));\r\n\r\n      localStorage.setItem('purchased', JSON.stringify(tempPurchased));\r\n      dispatch(purchasedSuccess(tempPurchased));\r\n    }, function (error) {\r\n      if (error) {\r\n        dispatch(completedFailure(error.toString()));\r\n        dispatch(alertActions.error(error.toString()));\r\n      }\r\n    });\r\n  };\r\n  \r\n  function completedSuccess(data) { return { type: dataConstants.UPDATE_COMPLETED_ORDERS_SUCCESS, data } }\r\n  function completedFailure(error) { return { type: dataConstants.UPDATE_COMPLETED_ORDERS_FAILURE, error } }\r\n  function purchasedSuccess(data) { return { type: dataConstants.UPDATE_PURCHASED_SUCCESS, data } }\r\n\r\n  function locationsSuccess(data) { return { type: dataConstants.UPDATE_LOCATIONS_SUCCESS, data } }\r\n  function locationsFailure(error) { return { type: dataConstants.UPDATE_LOCATIONS_FAILURE, error } }\r\n}\n\r\n\r\nfunction populateAddMeal() {\r\n  var user = JSON.parse(localStorage.getItem('userData'));\r\n  return dispatch => {\r\n    fire.database().ref('/restaurants/' + user.org + '/lockers/data').once('value', function (snapshot) {\r\n      let tempArray = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        var childData = childSnapshot.val();\r\n        tempArray[childData[\"type\"]] = childData;\r\n      });\r\n      localStorage.setItem('locations', JSON.stringify(tempArray));\r\n      dispatch(locationsSuccess(tempArray));\r\n    }, function (error) {\r\n      if (error) {\r\n        dispatch(locationsFailure(error.toString()));\r\n        dispatch(alertActions.error(error.toString()));\r\n      }\r\n    });\r\n  };\r\n\r\n  function locationsSuccess(data) { return { type: dataConstants.UPDATE_LOCATIONS_SUCCESS, data } }\r\n  function locationsFailure(error) { return { type: dataConstants.UPDATE_LOCATIONS_FAILURE, error } }\r\n}\r\n\r\nfunction populateInventory() {\r\n  var user = JSON.parse(localStorage.getItem('userData'));\r\n  return dispatch => {\r\n    fire.database().ref('/restaurants/' + user.org + '/templates/default/').once('value', function (snapshot) {\r\n      let tempArray = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        var childData = childSnapshot.val();\r\n        tempArray[childData[\"idTemplate\"]] = childData;\r\n      });\r\n      localStorage.setItem('inventory', JSON.stringify(tempArray));\r\n      dispatch(inventorySuccess(tempArray));\r\n    }, function (error) {\r\n      if (error) {\r\n        dispatch(inventoryFailure(error.toString()));\r\n        dispatch(alertActions.error(error.toString()));\r\n      }\r\n    });\r\n  };\r\n\r\n  function inventorySuccess(data) { return { type: dataConstants.UPDATE_INVENTORY_SUCCESS, data } }\r\n  function inventoryFailure(error) { return { type: dataConstants.UPDATE_INVENTORY_FAILURE, error } }\r\n}\r\n\r\nfunction populateDashboard() {\r\n  return dispatch => {\r\n    fire.database().ref('/lockers/data').once('value', function (snapshot) {\r\n      let tempArray = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        var childData = childSnapshot.val();\r\n        tempArray[childSnapshot.val().type] = childData;\r\n      });\r\n      localStorage.setItem('locations', JSON.stringify(tempArray));\r\n      dispatch(locationsSuccess(tempArray));\r\n    }, function (error) {\r\n      if (error) {\r\n        dispatch(locationsFailure(error.toString()));\r\n        dispatch(alertActions.error(error.toString()));\r\n      }\r\n      });\r\n    \r\n    fire.database().ref('/meals/forSale').once('value', function (snapshot) {\r\n      let tempArray = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        var childData = childSnapshot.val();\r\n        tempArray[childSnapshot.key] = childData;\r\n      });\r\n      localStorage.setItem('mealsForSale', JSON.stringify(tempArray));\r\n      dispatch(mealsForSaleSuccess(tempArray));\r\n    }, function (error) {\r\n      if (error) {\r\n        dispatch(mealsForSaleFailure(error.toString()));\r\n        dispatch(alertActions.error(error.toString()));\r\n      } \r\n      });\r\n\r\n    var mealsForSale = JSON.parse(localStorage.getItem('mealsForSale'));\r\n    fire.database().ref('/meals/all/meals').once('value', function (snapshot) {\r\n      let tempArray = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        var childData = childSnapshot.val();\r\n        if (mealsForSale[childSnapshot.key]) {\r\n          for (var i in childData) {\r\n            tempArray[childSnapshot.key] = childData[i];\r\n          }\r\n        }\r\n      });\r\n      localStorage.setItem('meals', JSON.stringify(tempArray));\r\n      dispatch(mealsSuccess(tempArray));\r\n    }, function (error) {\r\n      if (error) {\r\n        dispatch(mealsFailure(error.toString()));\r\n        dispatch(alertActions.error(error.toString()));\r\n      }\r\n    });\r\n    \r\n    var user = JSON.parse(localStorage.getItem('userData'));\r\n    fire.database().ref('/restaurants/' + user.org + '/inventory/pickedUp').once('value', function (snapshot) {\r\n      let tempArray = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        var childData = childSnapshot.val();\r\n        tempArray[childSnapshot.key] = childData;\r\n      });\r\n      localStorage.setItem('pickedUp', JSON.stringify(tempArray));\r\n      dispatch(pickedUpSuccess(tempArray));\r\n    }, function (error) {\r\n      if (error) {\r\n        dispatch(pickedUpFailure(error.toString()));\r\n        dispatch(alertActions.error(error.toString()));\r\n      }\r\n      });\r\n    \r\n    var pickedUp = JSON.parse(localStorage.getItem('pickedUp'));\r\n    fire.database().ref('/restaurants/' + user.org + '/orders/purchased').once('value', function (snapshot) {\r\n      let tempCompleted = {};\r\n      let tempPurchased = {};\r\n      snapshot.forEach(function (childSnapshot) {\r\n        childSnapshot.forEach(function (childChildSnapshot) {\r\n          var childData = childChildSnapshot.val();\r\n          if (pickedUp[childChildSnapshot.key]) {\r\n            for (var i in childData) {\r\n              tempCompleted[childChildSnapshot.key] = childData[i];\r\n            }\r\n          }\r\n          for (var j in childData) {\r\n            tempPurchased[childChildSnapshot.key] = childData[j];\r\n          }\r\n        })\r\n      });\r\n      localStorage.setItem('completed', JSON.stringify(tempCompleted));\r\n      dispatch(completedSuccess(tempCompleted));\r\n\r\n      localStorage.setItem('purchased', JSON.stringify(tempPurchased));\r\n      dispatch(purchasedSuccess(tempPurchased));\r\n    }, function (error) {\r\n      if (error) {\r\n        dispatch(completedFailure(error.toString()));\r\n        dispatch(alertActions.error(error.toString()));\r\n      }\r\n    });\r\n  };\r\n  \r\n  function mealsSuccess(data) { return { type: dataConstants.UPDATE_MEALS_SUCCESS, data } }\r\n  function mealsFailure(error) { return { type: dataConstants.UPDATE_MEALS_FOR_SALE_FAILURE, error } }\r\n  function completedSuccess(data) { return { type: dataConstants.UPDATE_COMPLETED_ORDERS_SUCCESS, data } }\r\n  function completedFailure(error) { return { type: dataConstants.UPDATE_COMPLETED_ORDERS_FAILURE, error } }\r\n  function purchasedSuccess(data) { return { type: dataConstants.UPDATE_PURCHASED_SUCCESS, data } }\r\n  function mealsForSaleFailure(error) { return { type: dataConstants.UPDATE_MEALS_FAILURE, error } }\r\n  function mealsForSaleSuccess(data) { return { type: dataConstants.UPDATE_MEALS_FOR_SALE_SUCCESS, data } }\r\n  function locationsSuccess(data) { return { type: dataConstants.UPDATE_LOCATIONS_SUCCESS, data } }\r\n  function locationsFailure(error) { return { type: dataConstants.UPDATE_LOCATIONS_FAILURE, error } } \r\n  function pickedUpSuccess(data) { return { type: dataConstants.UPDATE_PICKEDUP_SUCCESS, data } }\r\n  function pickedUpFailure(error) { return { type: dataConstants.UPDATE_PICKEDUP_FAILURE, error } }\r\n  };\r\n"]},"metadata":{},"sourceType":"module"}